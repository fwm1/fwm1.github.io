---
title: 接口幂等性方案
date: 2022-03-29 10:25:11
tags: [幂等]
categories: Java
---







## 什么是接口幂等性

同一个接口，被调用多次时，必须保证操作只执行一次。

场景：用户重复点击，网络请求失败导致重试等

## 如何保证幂等性

唯一索引

乐观锁

分布式锁

合理设置状态机（状态流转图）

全局唯一ID

防重表：

​    使用唯一主键去做防重表的唯一索引,比如使用订单号作为防重表的唯一索引,每一次请求都根据订单号向防重表中插入一条数据,插入成功说明可以处理后面的业务,当处理完业务逻辑之后删除防重表中的订单号数据,后续如果有重复请求,则会因为防重表唯一索引原因导致插入失败,直接返回操作失败,直到第一次请求返回结果,可以看出防重表作用就是加锁的功能。

